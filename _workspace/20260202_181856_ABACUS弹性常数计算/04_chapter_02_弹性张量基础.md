# 第二章：弹性张量基础

在开始实际计算之前，我们需要理解弹性张量的基本概念和计算原理。本章将介绍弹性常数的理论背景，为后续的计算实践打下基础。

## 2.1 什么是弹性张量

### 2.1.1 应力与应变

当材料受到外力作用时，会发生形变。在弹性极限内，这种形变是可逆的，即外力移除后材料会恢复原状。描述这种弹性行为需要两个基本物理量：

- **应力（Stress）**：材料内部单位面积上的内力，用张量 σᵢⱼ 表示，单位为 Pa 或 GPa
- **应变（Strain）**：材料的相对形变量，用张量 εᵢⱼ 表示，是无量纲量

应力和应变都是二阶对称张量，可以用 3×3 的对称矩阵表示。

### 2.1.2 广义胡克定律

在材料处于平衡位置附近，应力与应变之间的关系可以用**广义胡克定律**（Generalized Hooke's Law）表示：

$$
\sigma_{ij} = C_{ijkl} \varepsilon_{kl}
$$

其中：
- σᵢⱼ 是应力张量（i, j = x, y, z）
- εₖₗ 是应变张量（k, l = x, y, z）
- Cᵢⱼₖₗ 是**弹性刚度张量**（Elastic Stiffness Tensor），也称为弹性常数张量

弹性张量 Cᵢⱼₖₗ 是一个四阶张量，原则上有 3⁴ = 81 个分量。它描述了材料在不同方向上的弹性响应特性。

### 2.1.3 弹性张量的对称性

由于应力张量和应变张量都是对称张量（σᵢⱼ = σⱼᵢ，εₖₗ = εₗₖ），弹性张量也具有相应的对称性：

$$
C_{ijkl} = C_{jikl} = C_{ijlk} = C_{klij}
$$

经过对称性约化后，弹性张量的独立分量从 81 个减少到 **21 个**。这意味着，对于最一般的晶体（三斜晶系），我们只需要确定 21 个独立的弹性常数。

### 2.1.4 弹性张量的物理意义

弹性张量 Cᵢⱼₖₗ 本质上是一个耦合系数，它告诉我们：**当在 kl 方向上施加应变时，会在 ij 方向上诱导出多大的应力变化**。

例如：
- C₁₁₁₁（简写为 C₁₁）：沿 x 方向施加正应变时，x 方向产生的应力，反映材料沿主轴方向的刚度
- C₁₁₂₂（简写为 C₁₂）：沿 y 方向施加正应变时，x 方向产生的应力，反映泊松效应
- C₄₄：剪切应变产生的剪切应力，反映材料的剪切刚度

## 2.2 Voigt记号简化

### 2.2.1 为什么需要Voigt记号

四阶张量 Cᵢⱼₖₗ 的表示和计算都比较复杂。为了简化，我们使用 **Voigt 记号**（Voigt Notation）将四阶张量降维映射为二阶矩阵。

### 2.2.2 Voigt记号的映射规则

Voigt 记号使用如下的对应关系：

| 张量指标 | Voigt指标 |
|---------|----------|
| xx | 1 |
| yy | 2 |
| zz | 3 |
| yz (或 zy) | 4 |
| xz (或 zx) | 5 |
| xy (或 yx) | 6 |

### 2.2.3 简化后的表示

使用 Voigt 记号后：

- **应力张量**：从 3×3 矩阵简化为 6 维向量
  $$
  \sigma = [\sigma_1, \sigma_2, \sigma_3, \sigma_4, \sigma_5, \sigma_6]^T
  $$
  其中 σ₁ = σₓₓ，σ₂ = σᵧᵧ，σ₃ = σᵤᵤ，σ₄ = σᵧᵤ，σ₅ = σₓᵤ，σ₆ = σₓᵧ

- **应变张量**：从 3×3 矩阵简化为 6 维向量
  $$
  \varepsilon = [\varepsilon_1, \varepsilon_2, \varepsilon_3, \varepsilon_4, \varepsilon_5, \varepsilon_6]^T
  $$

- **弹性张量**：从四阶张量简化为 6×6 对称矩阵
  $$
  C = \begin{bmatrix}
  C_{11} & C_{12} & C_{13} & C_{14} & C_{15} & C_{16} \\
  C_{12} & C_{22} & C_{23} & C_{24} & C_{25} & C_{26} \\
  C_{13} & C_{23} & C_{33} & C_{34} & C_{35} & C_{36} \\
  C_{14} & C_{24} & C_{34} & C_{44} & C_{45} & C_{46} \\
  C_{15} & C_{25} & C_{35} & C_{45} & C_{55} & C_{56} \\
  C_{16} & C_{26} & C_{36} & C_{46} & C_{56} & C_{66}
  \end{bmatrix}
  $$

此时，广义胡克定律可以简化为矩阵形式：

$$
\begin{bmatrix} \sigma_1 \\ \sigma_2 \\ \sigma_3 \\ \sigma_4 \\ \sigma_5 \\ \sigma_6 \end{bmatrix} =
\begin{bmatrix}
C_{11} & C_{12} & C_{13} & C_{14} & C_{15} & C_{16} \\
C_{12} & C_{22} & C_{23} & C_{24} & C_{25} & C_{26} \\
C_{13} & C_{23} & C_{33} & C_{34} & C_{35} & C_{36} \\
C_{14} & C_{24} & C_{34} & C_{44} & C_{45} & C_{46} \\
C_{15} & C_{25} & C_{35} & C_{45} & C_{55} & C_{56} \\
C_{16} & C_{26} & C_{36} & C_{46} & C_{56} & C_{66}
\end{bmatrix}
\begin{bmatrix} \varepsilon_1 \\ \varepsilon_2 \\ \varepsilon_3 \\ \varepsilon_4 \\ \varepsilon_5 \\ \varepsilon_6 \end{bmatrix}
$$

虽然 6×6 矩阵有 36 个元素，但由于对称性（Cᵢⱼ = Cⱼᵢ），实际上只有 **21 个独立分量**（6 个对角元素 + 15 个非对角元素）。

## 2.3 晶体对称性的影响

### 2.3.1 点群对称性的约束

晶体的点群对称性会进一步对弹性张量的形式施加几何约束，使得独立分量数量继续减少。不同晶系的独立弹性常数数量如下：

| 晶系 | 点群对称性 | 独立弹性常数数量 |
|-----|----------|---------------|
| 三斜（Triclinic） | 最低 | 21 |
| 单斜（Monoclinic） | 低 | 13 |
| 正交（Orthorhombic） | 中等 | 9 |
| 四方（Tetragonal） | 较高 | 6 或 7 |
| 六方（Hexagonal） | 高 | 5 |
| 立方（Cubic） | 最高 | 3 |

### 2.3.2 立方晶系（以Si为例）

立方晶系具有极高的对称性，其弹性张量矩阵具有特殊的形式：

$$
C = \begin{bmatrix}
C_{11} & C_{12} & C_{12} & 0 & 0 & 0 \\
C_{12} & C_{11} & C_{12} & 0 & 0 & 0 \\
C_{12} & C_{12} & C_{11} & 0 & 0 & 0 \\
0 & 0 & 0 & C_{44} & 0 & 0 \\
0 & 0 & 0 & 0 & C_{44} & 0 \\
0 & 0 & 0 & 0 & 0 & C_{44}
\end{bmatrix}
$$

只有 **3 个独立弹性常数**：
- **C₁₁**：沿主轴方向的刚度（= C₂₂ = C₃₃）
- **C₁₂**：泊松效应（= C₁₃ = C₂₃）
- **C₄₄**：剪切刚度（= C₅₅ = C₆₆）

其他所有元素要么为 0，要么可以由这 3 个常数表示。

**物理意义**：
- C₁₁ 越大，材料沿主轴方向越难压缩
- C₁₂ 反映了横向应变与纵向应变的耦合
- C₄₄ 越大，材料抵抗剪切变形的能力越强

### 2.3.3 四方晶系（以金红石型TiO₂为例）

四方晶系（Laue 类型 I，4/mmm）的弹性张量矩阵形式为：

$$
C = \begin{bmatrix}
C_{11} & C_{12} & C_{13} & 0 & 0 & 0 \\
C_{12} & C_{11} & C_{13} & 0 & 0 & 0 \\
C_{13} & C_{13} & C_{33} & 0 & 0 & 0 \\
0 & 0 & 0 & C_{44} & 0 & 0 \\
0 & 0 & 0 & 0 & C_{44} & 0 \\
0 & 0 & 0 & 0 & 0 & C_{66}
\end{bmatrix}
$$

有 **6 个独立弹性常数**：
- **C₁₁**：垂直于 c 轴方向的刚度（= C₂₂）
- **C₃₃**：沿 c 轴方向的刚度
- **C₁₂**：垂直于 c 轴平面内的泊松效应
- **C₁₃**：c 轴与垂直方向的耦合（= C₂₃）
- **C₄₄**：包含 c 轴的剪切刚度（= C₅₅）
- **C₆₆**：垂直于 c 轴平面内的剪切刚度

相比立方晶系，四方晶系的对称性较低，因此需要更多的独立常数来描述其各向异性的弹性行为。

### 2.3.4 晶体取向的重要性

由于晶体的应力通常具有各向异性，弹性张量的具体形式与晶体的取向有关。因此，在比较不同来源的弹性张量计算结果时，需要确保晶体的取向一致。

在 Materials Project 数据库中，弹性张量数据通常会将晶体旋转到 **IEEE 176/1987 标准**规定的标准取向。此外，使用的原胞或惯用胞对弹性张量的形式也有影响。

对于 Si、Cu 等常见的立方晶系晶体，计算弹性模量时通常使用**正方体形式的惯用胞**，并且使用坐标轴与惯用胞晶格矢量重合的坐标系。

## 2.4 应力-应变法计算原理

### 2.4.1 基本思想

目前在计算材料弹性张量时被广泛使用的方法是**应力-应变法**（Stress-Strain Method）。这种方法的理论基础是广义胡克定律：

$$
\sigma = C \varepsilon
$$

基本思想是：
1. 对材料施加一系列已知的应变 ε
2. 通过第一性原理计算获取材料的内部应力 σ
3. 通过线性拟合应力-应变关系，得到弹性张量 C

### 2.4.2 应变模式设计

为了确定弹性张量的所有独立分量，需要施加不同类型的应变：

**正应变（Normal Strain）**：
- 沿 x 方向：ε₁ ≠ 0，其他为 0
- 沿 y 方向：ε₂ ≠ 0，其他为 0
- 沿 z 方向：ε₃ ≠ 0，其他为 0

**剪切应变（Shear Strain）**：
- yz 平面：ε₄ ≠ 0，其他为 0
- xz 平面：ε₅ ≠ 0，其他为 0
- xy 平面：ε₆ ≠ 0，其他为 0

对于每种应变状态，通常施加多个不同大小的应变值（例如 ±0.5% 和 ±1%），以便进行线性拟合。

### 2.4.3 典型计算流程

完整的弹性常数计算流程包括以下步骤：

1. **结构优化**：优化晶体的晶胞和原子位置，获取无应力的平衡结构
2. **（可选）晶体旋转**：将晶体旋转至 IEEE 176/1987 标准规定的标准取向
3. **生成变形结构**：对所有可能的正应变和剪切应变，施加一批不同大小的应变，生成变形后的结构
4. **第一性原理计算**：对每个变形结构进行 DFT 计算，获取应力张量
5. **线性拟合**：拟合应力-应变关系，得到完整的弹性张量矩阵

### 2.4.4 应变大小的选择

应变大小的选择需要权衡两个因素：

- **应变太小**：应力的计算误差相对较大，拟合精度降低
- **应变太大**：超出线弹性范围，胡克定律不再适用

通常，**应变大小选择在 ±0.5% 到 ±1% 之间**是合适的。在 abacustest 中，默认的最大应变为 0.01（即 ±1%）。

### 2.4.5 原子弛豫的考虑

在施加应变后，有两种处理方式：

- **固定原子位置**（Clamped-ion）：只改变晶格，原子位置随晶格仿射变换
- **允许原子弛豫**（Relaxed-ion）：固定晶格，允许原子位置优化

通常采用**允许原子弛豫**的方式，因为这更接近实际情况。在 ABACUS 中，这对应于 `calculation = relax`（固定晶格的结构优化）。

## 2.5 弹性模量的计算

从弹性张量可以进一步计算出各种宏观弹性模量：

### 2.5.1 体模量（Bulk Modulus, B）

体模量描述材料抵抗均匀压缩的能力，单位为 GPa。体模量越大，材料越难压缩。

对于立方晶系：
$$
B = \frac{C_{11} + 2C_{12}}{3}
$$

### 2.5.2 剪切模量（Shear Modulus, G）

剪切模量描述材料抵抗剪切变形的能力，单位为 GPa。

计算方法有多种，常用的是 Voigt-Reuss-Hill 平均。

### 2.5.3 杨氏模量（Young's Modulus, E）

杨氏模量描述材料在单轴拉伸或压缩时的刚度，单位为 GPa。

可以从体模量和剪切模量计算：
$$
E = \frac{9BG}{3B + G}
$$

### 2.5.4 泊松比（Poisson's Ratio, ν）

泊松比描述材料在单轴拉伸时横向收缩与纵向伸长的比值，无量纲。

$$
\nu = \frac{3B - 2G}{2(3B + G)}
$$

泊松比的典型范围是 0 到 0.5，大多数材料在 0.2 到 0.3 之间。

---

## 本章小结

本章介绍了弹性张量的基本概念和计算原理：

- **弹性张量**：描述应力与应变之间线性关系的四阶张量，经对称性约化后有 21 个独立分量
- **Voigt 记号**：将四阶张量简化为 6×6 对称矩阵，便于计算和表示
- **晶体对称性**：不同晶系的独立弹性常数数量不同，立方晶系只有 3 个，四方晶系有 6 个
- **应力-应变法**：通过施加应变、计算应力、线性拟合来确定弹性张量
- **弹性模量**：从弹性张量可以计算体模量、剪切模量、杨氏模量、泊松比等宏观性质

在下一章中，我们将介绍 abacustest 工具的使用，为实际计算做准备。
