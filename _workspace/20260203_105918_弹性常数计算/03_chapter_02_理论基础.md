# 第2章：理论基础

## 2.1 广义胡克定律与弹性张量

在线弹性范围内，晶体的应力张量 σ 与应变张量 ε 满足线性关系，这就是广义胡克定律：

$$
\sigma_{ij} = C_{ijkl} \varepsilon_{kl}
$$

其中：
- σ_ij：应力张量（二阶对称张量）
- ε_kl：应变张量（二阶对称张量）
- C_ijkl：弹性张量（四阶张量），包含81个分量

由于应力和应变都是对称张量，弹性张量也具有对称性：

$$
C_{ijkl} = C_{jikl} = C_{ijlk} = C_{klij}
$$

经过对称性约化，弹性张量的独立分量从81个减少到21个。

## 2.2 Voigt记号

为了简化表示，引入Voigt记号将四阶张量降维为6×6矩阵。映射规则如下：

| 张量指标 | Voigt指标 |
|---------|----------|
| xx (11) | 1 |
| yy (22) | 2 |
| zz (33) | 3 |
| yz (23) | 4 |
| xz (13) | 5 |
| xy (12) | 6 |

使用Voigt记号后，应力和应变可表示为6维向量，弹性张量表示为6×6对称矩阵，广义胡克定律简化为：

$$
\begin{bmatrix}
\sigma_1 \\
\sigma_2 \\
\sigma_3 \\
\sigma_4 \\
\sigma_5 \\
\sigma_6
\end{bmatrix}
=
\begin{bmatrix}
C_{11} & C_{12} & C_{13} & C_{14} & C_{15} & C_{16} \\
C_{12} & C_{22} & C_{23} & C_{24} & C_{25} & C_{26} \\
C_{13} & C_{23} & C_{33} & C_{34} & C_{35} & C_{36} \\
C_{14} & C_{24} & C_{34} & C_{44} & C_{45} & C_{46} \\
C_{15} & C_{25} & C_{35} & C_{45} & C_{55} & C_{56} \\
C_{16} & C_{26} & C_{36} & C_{46} & C_{56} & C_{66}
\end{bmatrix}
\begin{bmatrix}
\varepsilon_1 \\
\varepsilon_2 \\
\varepsilon_3 \\
\varepsilon_4 \\
\varepsilon_5 \\
\varepsilon_6
\end{bmatrix}
$$

对于一般晶体，这个6×6矩阵是对称的，包含21个独立分量。

## 2.3 晶体对称性的影响

晶体的点群对称性会进一步约束弹性张量的形式，使独立分量数量减少。不同晶系的独立弹性常数数量如下：

| 晶系 | 独立分量数 | 独立弹性常数 |
|------|-----------|-------------|
| 三斜 (Triclinic) | 21 | 全部21个 |
| 单斜 (Monoclinic) | 13 | - |
| 正交 (Orthorhombic) | 9 | - |
| 六方 (Hexagonal) | 5 | C₁₁, C₁₂, C₁₃, C₃₃, C₄₄ |
| 四方 (Tetragonal) | 6 | C₁₁, C₁₂, C₁₃, C₃₃, C₄₄, C₆₆ |
| 立方 (Cubic) | 3 | C₁₁, C₁₂, C₄₄ |

### 立方晶系（Si）

立方晶系具有最高的对称性，弹性张量只有3个独立分量：

$$
\begin{bmatrix}
C_{11} & C_{12} & C_{12} & 0 & 0 & 0 \\
C_{12} & C_{11} & C_{12} & 0 & 0 & 0 \\
C_{12} & C_{12} & C_{11} & 0 & 0 & 0 \\
0 & 0 & 0 & C_{44} & 0 & 0 \\
0 & 0 & 0 & 0 & C_{44} & 0 \\
0 & 0 & 0 & 0 & 0 & C_{44}
\end{bmatrix}
$$

其中 C₁₁ = C₂₂ = C₃₃，C₁₂ = C₁₃ = C₂₃，C₄₄ = C₅₅ = C₆₆，其他元素为0。

### 四方晶系（TiO₂）

四方晶系（Laue类型I）有6个独立分量：

$$
\begin{bmatrix}
C_{11} & C_{12} & C_{13} & 0 & 0 & 0 \\
C_{12} & C_{11} & C_{13} & 0 & 0 & 0 \\
C_{13} & C_{13} & C_{33} & 0 & 0 & 0 \\
0 & 0 & 0 & C_{44} & 0 & 0 \\
0 & 0 & 0 & 0 & C_{44} & 0 \\
0 & 0 & 0 & 0 & 0 & C_{66}
\end{bmatrix}
$$

其中 C₁₁ = C₂₂，C₄₄ = C₅₅，但 C₁₁ ≠ C₃₃，C₄₄ ≠ C₆₆。

## 2.4 应力-应变法

应力-应变法是计算弹性常数的推荐方法，其基本原理是：

1. **施加应变**：对优化后的晶体结构施加一系列微小应变（正应变和剪切应变）
2. **计算应力**：使用第一性原理计算每个变形结构的应力张量
3. **线性拟合**：根据广义胡克定律，通过线性拟合应力-应变关系得到弹性常数

相比能量-应变法，应力-应变法具有以下优势：
- **高效**：单次DFT计算输出6个应力分量，而能量法只输出1个标量
- **稳定**：线性拟合比二次拟合对数值噪声更不敏感
- **标准**：Materials Project等数据库的标准方法

### 应变设置

对于3维晶体，需要施加6种应变状态（3种正应变 + 3种剪切应变）：
- 正应变：ε₁、ε₂、ε₃（沿x、y、z方向）
- 剪切应变：ε₄、ε₅、ε₆（yz、xz、xy平面）

对每种应变，通常施加4种不同大小：±0.5%和±1%（即 ε ∈ {-0.01, -0.005, 0.005, 0.01}），共产生24个变形结构。

### 计算流程

1. 优化晶体结构，获得无应力的平衡构型
2. 对平衡构型施加应变，生成变形结构
3. 对每个变形结构进行DFT计算（固定晶格，允许原子弛豫）
4. 提取应力张量
5. 对每种应变类型，线性拟合应力-应变关系，得到对应的弹性常数

## 2.5 晶体取向

弹性张量的具体数值与晶体的取向有关。为了便于比较，Materials Project等数据库通常将晶体旋转到IEEE 176/1987标准规定的标准取向。对于Si、Cu等立方晶系，通常使用正方体形式的惯用胞，坐标轴与晶格矢量重合。

abacustest工具在生成变形结构时，假设输入的晶体结构已经处于合适的取向。对于从Materials Project下载的结构，通常已经满足这一要求。
