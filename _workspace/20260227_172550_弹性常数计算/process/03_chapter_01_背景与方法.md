# 一、背景与方法

## 1.1 弹性张量与广义胡克定律

晶体在外力作用下会产生形变（应变），内部相应地产生应力。在材料处于平衡位置附近的线弹性范围内，应力张量 σ_ij 与应变张量 ε_kl 之间的关系由广义胡克定律描述：

$$\sigma_{ij} = C_{ijkl}\,\varepsilon_{kl}$$

其中 C_ijkl 是四阶弹性刚度张量。由于应力和应变都是二阶对称张量，C_ijkl 满足以下对称性：

$$C_{ijkl} = C_{jikl},\quad C_{ijkl} = C_{ijlk},\quad C_{ijkl} = C_{klij}$$

经过对称性约化，81 个分量缩减为 **21 个独立分量**。

利用 **Voigt 标记**，用如下对应关系将 4 阶张量映射为 6×6 对称矩阵：

$$xx\to 1,\quad yy\to 2,\quad zz\to 3,\quad yz\to 4,\quad xz\to 5,\quad xy\to 6$$

应力和应变各写为 6 维列向量，胡克定律化为矩阵形式：

$$\begin{bmatrix}\sigma_1\\\sigma_2\\\sigma_3\\\sigma_4\\\sigma_5\\\sigma_6\end{bmatrix}=\begin{bmatrix}C_{11}&C_{12}&C_{13}&C_{14}&C_{15}&C_{16}\\&C_{22}&C_{23}&C_{24}&C_{25}&C_{26}\\&&C_{33}&C_{34}&C_{35}&C_{36}\\&&&C_{44}&C_{45}&C_{46}\\&&&&C_{55}&C_{56}\\&&&&&C_{66}\end{bmatrix}\begin{bmatrix}\varepsilon_1\\\varepsilon_2\\\varepsilon_3\\\varepsilon_4\\\varepsilon_5\\\varepsilon_6\end{bmatrix}$$

## 1.2 晶体对称性的约束

晶体的点群对称性会进一步减少独立分量数：

| 晶系 | 独立分量数 | 示例 |
|------|-----------|------|
| 三斜晶系 | 21 | — |
| 单斜晶系 | 13 | — |
| 正交晶系 | 9 | — |
| 六方晶系 | 5 | — |
| 四方晶系（Laue I） | 6 | 金红石 TiO₂ |
| 立方晶系 | 3 | Si、Cu |

**立方晶系**（Si）：独立分量只有 3 个——C₁₁（= C₂₂ = C₃₃）、C₁₂（= C₁₃ = C₂₃）、C₄₄（= C₅₅ = C₆₆），矩阵其余非对角元素均为 0。

**四方晶系**（金红石型 TiO₂，Laue 类型 I）：独立分量为 C₁₁（= C₂₂）、C₁₂、C₁₃（= C₂₃）、C₃₃、C₄₄（= C₅₅）、C₆₆，共 6 个。

计算结果与 Materials Project 数据库对比时，还需注意晶体取向。Materials Project 采用 IEEE 176/1987 标准取向。对于本教程中的 Si，由 ase 生成的立方惯用胞晶格矢量已与坐标轴对齐，无需额外旋转。

## 1.3 计算方法：应力-应变法

目前计算弹性张量最常用的方法是**应力-应变法**：

1. 对优化后的平衡结构施加一系列已知应变
2. 用第一性原理计算各形变结构的应力
3. 对应力-应变数据线性拟合，得到弹性张量元

**abacustest 的实现方案：**

对 6 种独立应变（3 种正应变 + 3 种剪切应变），每种取 4 个幅度（±0.5%、±1%），共生成 **24 个形变构型**。对每个构型做固定晶格的 relax 计算（允许原子弛豫后再计算应力），以减少数值噪声。再加 1 个原始结构（org），合计 **25 个计算任务**。

**完整工作流：**

```
生成/下载晶体结构（CIF）
        ↓
abacustest model inputs  →  准备 cell-relax 输入
        ↓
提交并等待结构优化完成
        ↓
整理优化后结构，准备 SCF 目录
        ↓
abacustest model elastic prepare  →  生成 24+1 个形变构型
        ↓
提交并等待弹性计算完成
        ↓
abacustest model elastic post  →  输出弹性张量和力学性质
```
