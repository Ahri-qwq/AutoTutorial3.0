# 教程测试报告

**生成时间：** 2026-02-27 19:30
**测试教程：** `_workspace/20260227_172550_弹性常数计算/07_Final_Tutorial_使用abacustest计算晶体弹性性质.md`
**测试目录：** `_workspace/20260227_172550_弹性常数计算/test_20260227_181014/`

---

## 测试概要

- ⚠️ **测试状态：部分通过**
- 📊 **测试案例：** Si（立方晶系），仅测试 cell-relax + elastic 工作流
- ⏱️ **总耗时：** 约 90 分钟
- 🔑 **关键发现：** 轨道文件差异（7au vs 8au）导致弹性常数系统性偏差

---

## 案例：Si（立方晶系）

### 计算步骤

| 步骤 | Job ID | 状态 | 耗时 |
|------|--------|------|------|
| cell-relax | 22146102 | ✅ Finished | 650s |
| deformed_00~deformed_23 + org | 22146139~22146163 | ✅ Finished | ~800s/个 |

### 弹性常数对比

| 参数 | 教程预期 | 实际结果（8au轨道） | 相对误差 | 状态 |
|------|---------|---------------------|---------|------|
| C₁₁ (GPa) | 155.5 | 165.46 | +6.4% | ⚠️ 超出5%容差 |
| C₁₂ (GPa) | 58.2 | 58.56 | +0.6% | ✅ PASS |
| C₄₄ (GPa) | 76.2 | 82.52 | +8.3% | ⚠️ 超出5%容差 |

### 弹性模量对比

| 参数 | 教程预期 | 实际结果 | 相对误差 | 状态 |
|------|---------|---------|---------|------|
| 体模量 (GPa) | 90.71 | 94.19 | +3.8% | ✅ PASS |
| 剪切模量 (GPa) | 65.13 | 70.89 | +8.8% | ⚠️ 超出5%容差 |
| 杨氏模量 (GPa) | 157.66 | 170.02 | +7.8% | ⚠️ 超出5%容差 |
| 泊松比 | 0.210 | 0.199 | -5.2% | ⚠️ 临界 |

### 弹性张量矩阵（实际结果，单位 GPa）

```
        C₁₁      C₁₂      C₁₃      C₄₄
    165.456   58.560   58.560    0.000
     58.560  165.456   58.560    0.000
     58.560   58.560  165.456    0.000
      0.000    0.000    0.000   82.522
      0.000    0.000    0.000    0.000   82.522
      0.000    0.000    0.000    0.000    0.000   82.522
```

矩阵结构：✅ 完全满足立方晶系对称性（非对角元 ~10⁻¹⁰ GPa）

---

## 根因分析

### 轨道文件差异（主要原因）

| 项目 | 轨道文件 |
|------|---------|
| 原始教程计算（昨日 Job 22137391） | `Si_gga_7au_100Ry_2s2p1d.orb` |
| 本次测试 | `Si_gga_8au_100Ry_2s2p1d.orb` |

- `Si_gga_7au_100Ry_2s2p1d.orb` 不在本地缓存（`tools/orbitals/`），也不在 ABACUS GitHub 仓库中
- `orbital_db.py` 中有 7au→8au 的修正映射，导致本次测试自动使用 8au
- **两种轨道文件的截断半径不同（7 bohr vs 8 bohr），给出不同的弹性常数**

### 与实验值对比

| 参数 | 实验值 | 本次（8au） | 教程（7au） |
|------|--------|------------|------------|
| C₁₁ (GPa) | 165.7 | 165.46 ✅ | 155.5 ❌ |
| C₁₂ (GPa) | 63.9 | 58.56 | 58.2 |
| C₄₄ (GPa) | 79.6 | 82.52 | 76.2 |

**本次计算（8au轨道）的 C₁₁ 更接近实验值（误差 0.1%）。**

### 工作流验证

| 流程步骤 | 验证结果 |
|---------|---------|
| ase 生成 Si 惯用胞 CIF | ✅ 正确 |
| abacustest model inputs → cell-relax | ✅ INPUT/STRU/KPT 正确生成 |
| ABACUS cell-relax → STRU_ION_D | ✅ 优化后 a=5.4702 Å（PBE典型值） |
| abacustest model elastic prepare | ✅ 生成 25 个变形目录（deformed_00~23 + org） |
| 25个 relax+stress 计算 | ✅ 全部完成 |
| abacustest model elastic post | ✅ 正确提取弹性张量，矩阵对称性完美 |

**关键差异记录：**
- 教程描述目录名为 `deform-`，实际生成为 `deformed_`（abacustest 版本差异）

---

## 结论

✅ **计算工作流完全正确可复现**

⚠️ **数值结果存在系统性偏差**，原因是轨道文件不同（7au vs 8au），而非教程流程错误。

### 建议

1. **获取 `Si_gga_7au_100Ry_2s2p1d.orb`**：尝试从 ABACUS 官方渠道获取，加入 `tools/orbitals/` 缓存，可复现教程原始数值
2. **或更新教程数值**：若 7au 轨道无法获取，将教程中 C₁₁=155.5→165.5，C₄₄=76.2→82.5 等值更新为 8au 结果（物理上更准确）
3. **更新目录名描述**：教程第 3.4 节将 `deform-` 改为 `deformed_`

---

## 测试详情

### 任务信息

| 任务 | Job ID | 机型 | 镜像 |
|------|--------|------|------|
| Si-cell-relax | 22146102 | c16_m32_cpu | abacus:LTSv3.10.1 |
| Si_elastic_deformed_00 | 22146139 | c16_m32_cpu | abacus:LTSv3.10.1 |
| ... | ... | ... | ... |
| Si_elastic_org | 22146163 | c16_m32_cpu | abacus:LTSv3.10.1 |

### 环境信息
- Python: 3.12.9
- Bohrium CLI: 1.1.0
- abacustest: 0.4.56
- ABACUS 镜像: registry.dp.tech/dptech/abacus:LTSv3.10.1

---

**测试框架版本：** AutoTutorial 3.0
**生成工具：** testCLAUDE.md 测试流程
